@model Young.Web.Models.CustomList.TableDetailModel

@{
    ViewBag.Title = "自定义列表";
    Layout = "~/Views/Shared/_WebmasterLayout.cshtml";
}

@section scripts{
    <script>
        var _columns = [];
        //自定义列
        $(function () {

            $('#dg').datagrid({
                title: '自定义列表：@Model.TableName',
                singleSelect: true,
                toolbar: '#toolbar',
                pagination: true,
                rownumbers: true,
                fitcolumns: true
            });
        });

        function newRecord() {
            Young.CreateRecordDataDialog(_columns, '@ViewBag.Name', '#dg');
        }

        function deleteRecord() {
            var row = $('#dg').datagrid('getSelected');
            if (row == null) {
                $.messager.alert('信息', '请先选中记录。', 'info'); return;
            }
            $.post('/api/apicustomlistdata', {
                CustomListName: '@ViewBag.Name',
                CommandType: 'Delete',
                JsonData: '',
                ID: row.ID
            }, function () {
                $('#dg').datagrid('reload');
            });
            }

            function editRecord() {
                $.messager.alert('信息', '该功能暂未开通。', 'info');
            }
    </script>
}
<table id="dg" style="width: auto; height: auto">
    <thead>
        <tr>
            @foreach (var column in Model.ListColumns)
            {
                <th data-options="field:'@column.Code'">@column.Name</th>
            }
        </tr>
    </thead>
</table>
<div id="toolbar" style="padding: 10px 0;">
    <a href="AddData?tcode=@Model.TableCode" class="easyui-linkbutton" iconcls="icon-page-add" plain="true">添加记录</a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-page-edit" plain="true" onclick="editRecord()">编辑记录</a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconcls="icon-page-delete" plain="true" onclick="deleteRecord()">删除记录</a>
</div>
